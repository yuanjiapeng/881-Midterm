881report.R
yuanjiapeng
Sun Oct 18 19:02:47 2015
#Jiapeng Yuan
#I choose to use "DEMOGRAPHICS.csv to do my analysis. 
#this is a file that identifies the data element and values in Demographics indicator domain
# this file include the variables :County names, State, Populations(min,max),Poverty(min,max),Age,race
#First, because there are 3141 counties, so clustering might be a good way to put counties into group
#Choosing the right number of clusters is important, so we have to decide what number we use first
#We can use Hartigan's Rule
#It compares the ratio of the within-cluster sum of squares for a clustering 
#One with k clusters and one with k+1 clusterd.
#In order to use Hartigan's Rule, we need to use "useful" package and FitKMeans function
library(useful)
## Loading required package: ggplot2
demo <- read.csv("~/Downloads/chsi_dataset/DEMOGRAPHICS.csv")
demo1<-demo[,(8:44)]
set.seed(50)
dim(demo1)
## [1] 3141   37
demoBest<-FitKMeans(demo1,max.clusters = 20,nstart = 25,seed=50)
demoBest
##    Clusters      Hartigan AddCluster
## 1         2  7287.7321040       TRUE
## 2         3  3103.2501172       TRUE
## 3         4   682.0406298       TRUE
## 4         5   399.1328825       TRUE
## 5         6   108.3237791       TRUE
## 6         7    39.3272425       TRUE
## 7         8     3.3483880      FALSE
## 8         9     0.8131359      FALSE
## 9        10     3.3840631      FALSE
## 10       11     0.5333648      FALSE
## 11       12     0.8439277      FALSE
## 12       13    31.0915779       TRUE
## 13       14    -9.5036308      FALSE
## 14       15  6672.9989865       TRUE
## 15       16    11.5488270       TRUE
## 16       17 -2131.5408194      FALSE
## 17       18  6675.0224150       TRUE
## 18       19   129.8028083       TRUE
## 19       20  -118.0495611      FALSE
PlotHartigan(demoBest)
 
#According to this metric we should use 7 clusters.
#Now , we run a Kmeans function to see the clusters
#and make a plot about this it
demok <- kmeans(x = demo1, centers = 7)
demok
## K-means clustering with 7 clusters of sizes 386, 110, 1617, 71, 630, 293, 34
## 
## Cluster means:
##   Number_Counties Population_Size Min_Population_Size Max_Population_Size
## 1        36.81865        77711.60           57517.228           100193.39
## 2        28.38182       400854.32          287038.418           518078.48
## 3        40.75634        12290.51            6309.288            19236.41
## 4        35.84507       760103.34          571318.746           933789.75
## 5        34.52381        38575.75           28610.727            49920.17
## 6        41.62799       172310.97          118354.614           247022.03
## 7        34.00000      2167318.15         1214361.000          3635528.00
##   Population_Density Min_Population_Density Max_Population_Density
## 1          151.55699               53.43523               256.4249
## 2          856.94545              278.85455              1616.0364
## 3           50.11441               13.97526               110.3531
## 4         2185.32394              544.67606              6073.8310
## 5           89.93016               32.43333               118.8381
## 6          392.74403               95.78157               605.8225
## 7         6523.41176              395.00000             20520.0000
##    Poverty Min_Poverty Max_Poverty Age_19_Under Min_Age_19_Under
## 1 12.40311   10.103109    14.60207     25.23394         22.71684
## 2 10.76455    7.833636    13.44000     26.37364         23.17909
## 3 12.73612   11.628386    16.81206     24.25510         21.25949
## 4 11.71972    8.766197    15.18310     26.37183         23.30141
## 5 13.44127   11.185556    16.00810     25.04413         22.43968
## 6 11.51399    9.397270    13.50717     25.59352         23.09761
## 7 13.45882    7.600000    18.90000     26.65588         22.80000
##   Max_Age_19_Under Age_19_64 Min_Age_19_64 Max_Age_19_65 Age_65_84
## 1         27.49534  61.56684      59.11658      64.25648  11.44663
## 2         29.13545  61.60182      58.92545      64.53182  10.35909
## 3         27.51045  59.37347      55.84793      62.84966  13.95591
## 4         30.60282  61.93521      59.34648      65.57887  10.01268
## 5         27.61048  60.76714      58.19762      63.38127  12.29349
## 6         28.29181  61.60102      58.82867      63.98635  11.08225
## 7         29.80000  61.50882      59.50000      63.80000  10.12059
##   Min_Age_65_84 Max_Age_65_85 Age_85_and_Over Min_Age_85_and_Over
## 1      9.036269      13.74534        1.753109           1.1782383
## 2      7.667273      13.39273        1.678182           0.9463636
## 3     11.242053      16.63840        2.415337           1.6013605
## 4      7.309859      12.21972        1.685915           0.9549296
## 5      9.981429      14.34429        1.896190           1.3690476
## 6      8.451195      14.06724        1.724573           1.1310580
## 7      7.500000      12.70000        1.705882           1.0000000
##   Max_Age_85_and_Over    White Min_White Max_White     Black Min_Black
## 1            2.370466 87.35777  73.52668  97.12306  8.783679 0.6971503
## 2            2.559091 82.39091  66.19455  93.90455 12.006364 1.7127273
## 3            3.299258 88.06085  72.43234  98.17335  8.161039 0.6563389
## 4            2.345070 74.44366  55.92113  89.58310 16.601408 2.8591549
## 5            2.457778 87.94048  73.61159  97.95778  8.888889 0.4373016
## 6            2.401706 85.24778  73.13242  95.52867 10.150853 1.2754266
## 7            2.500000 72.94412  53.70000  86.10000 16.667647 4.3000000
##   Max_Black Native_American Min_Native_American Max_Native_American
## 1  22.56995       1.4738342           0.1911917            2.801554
## 2  27.51727       0.6181818           0.2000000            1.249091
## 3  20.56988       2.6346939           0.1602968            8.091960
## 4  37.46338       0.7126761           0.2000000            2.383099
## 5  23.51603       1.5106349           0.1606349            4.457619
## 6  22.24676       0.9481229           0.1938567            1.658020
## 7  38.30000       0.7000000           0.2000000            1.200000
##       Asian Min_Asian Max_Asian  Hispanic Min_Hispanic Max_Hispanic
## 1 1.2253886 0.3992228  2.216580  5.347668    1.0277202     13.25933
## 2 3.3709091 1.1381818  6.360000 10.940000    2.3490909     30.53818
## 3 0.5430427 0.1085343  1.014780  6.620284    0.7626469     18.72103
## 4 6.3098592 2.1309859 11.929577 14.745070    2.2901408     32.06197
## 5 0.7182540 0.2615873  1.454286  6.106190    0.8396825     16.02556
## 6 2.1819113 0.7047782  4.060410  8.215358    1.3197952     19.32799
## 7 7.8176471 2.2000000 16.200000 22.647059    3.1000000     46.40000
## 
## Clustering vector:
##    [1] 5 6 5 3 5 3 3 6 5 3 5 3 5 3 3 5 1 3 3 5 3 1 5 5 1 1 5 6 3 5 3 3 3 3
##   [35] 1 1 4 3 1 5 1 1 3 3 2 3 5 1 2 3 6 6 3 3 5 3 1 1 6 3 1 5 6 1 3 3 3 3
##   [69] 3 2 3 3 3 3 1 3 5 5 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 1 6 1 5 5 3 3 7
##  [103] 6 1 4 6 5 6 6 3 3 5 6 5 3 3 3 3 3 3 3 3 5 3 1 5 5 3 3 3 3 1 3 3 1 3
##  [137] 5 3 5 3 5 3 3 1 3 3 3 3 3 3 3 5 3 3 5 1 3 3 3 3 5 3 5 3 3 3 1 3 2 3
##  [171] 5 1 3 3 6 3 3 3 5 3 6 1 3 3 7 3 5 6 5 3 4 5 6 4 5 6 6 3 4 6 1 5 7 6
##  [205] 6 3 1 6 3 3 2 6 1 7 6 3 7 7 5 7 7 4 4 6 4 2 7 6 6 3 5 2 2 2 1 1 3 2
##  [239] 1 4 6 1 2 3 2 3 3 3 2 5 3 3 3 3 3 3 3 5 2 3 6 5 3 2 5 5 3 3 3 3 3 3
##  [273] 4 3 3 3 5 6 3 3 3 6 3 3 3 5 5 3 3 3 3 3 3 6 3 3 3 3 3 3 3 3 3 3 6 3
##  [307] 4 4 6 6 4 2 6 6 6 2 6 4 6 3 6 3 2 7 3 6 6 6 6 1 5 3 4 2 5 3 5 3 3 3
##  [341] 3 3 5 6 1 4 3 1 5 3 3 6 2 6 5 3 3 6 6 6 7 1 1 6 5 4 6 7 2 4 2 1 6 6
##  [375] 6 2 2 5 5 3 3 2 3 5 3 3 3 3 3 5 3 5 1 3 3 6 3 3 3 3 5 3 3 3 5 3 1 5
##  [409] 3 6 3 3 6 1 3 6 3 4 5 5 1 3 1 3 3 3 3 5 4 3 3 1 1 3 3 5 3 3 3 3 1 1
##  [443] 1 3 4 3 3 1 5 3 3 4 5 6 3 3 3 3 3 1 6 3 5 3 3 3 3 3 3 3 3 5 3 1 3 3
##  [477] 1 3 3 3 3 3 3 3 3 3 3 3 3 5 6 1 3 3 1 3 3 3 3 5 3 3 3 3 3 6 1 3 3 3
##  [511] 1 5 3 5 3 3 3 3 3 3 5 5 5 3 3 1 3 3 3 5 1 1 5 3 3 5 3 3 3 1 3 3 3 3
##  [545] 6 4 3 1 6 2 3 1 3 3 5 3 3 5 1 3 3 3 6 3 3 3 3 3 3 3 3 3 3 3 3 3 1 5
##  [579] 3 3 3 3 3 5 3 3 3 3 3 3 1 3 3 1 3 3 5 3 5 3 3 3 6 5 3 3 5 1 7 3 3 1
##  [613] 3 3 4 3 3 5 3 3 5 5 3 3 5 3 3 3 3 1 5 1 3 5 3 3 3 2 6 5 1 4 6 3 5 5
##  [647] 5 5 6 6 6 5 2 5 3 3 3 3 3 5 5 5 3 1 6 3 3 3 3 3 3 5 3 6 2 5 6 3 3 3
##  [681] 3 5 6 3 1 3 3 3 3 3 1 2 1 2 5 5 2 1 3 3 5 3 3 5 1 5 5 3 5 5 5 5 6 5
##  [715] 6 5 1 3 3 3 5 1 5 6 1 5 1 5 1 5 5 5 3 5 5 6 5 1 5 2 6 5 6 4 5 3 5 6
##  [749] 5 1 3 5 3 3 3 3 3 3 6 5 3 5 5 5 3 2 3 5 3 3 5 3 3 6 3 3 6 3 6 5 3 1
##  [783] 5 1 5 5 5 3 3 3 3 3 5 6 5 3 3 3 3 3 3 3 3 5 3 3 3 3 3 1 3 5 3 3 3 5
##  [817] 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 3 6 3 3 3 5 6 3 3 3 3 3 5
##  [851] 5 3 3 3 3 3 5 3 3 3 3 3 3 2 1 3 3 3 6 3 5 1 3 3 3 3 5 5 3 3 5 3 3 6
##  [885] 3 3 3 3 3 3 5 3 3 1 3 3 3 3 3 3 3 3 3 5 5 3 3 3 1 3 3 5 3 5 5 3 5 3
##  [919] 3 3 3 3 3 3 3 5 3 3 3 3 3 2 3 3 3 3 3 1 3 3 3 5 5 3 3 3 5 3 5 3 3 3
##  [953] 3 3 3 3 3 3 3 3 3 3 3 1 3 3 1 3 3 3 1 3 2 3 6 3 3 3 3 3 3 5 3 3 3 3
##  [987] 3 3 3 3 6 3 3 3 3 5 3 5 1 3 5 5 3 3 3 1 3 3 5 1 3 3 5 3 1 5 3 3 3 3
## [1021] 1 3 3 3 6 3 5 5 3 3 3 3 5 3 3 5 3 1 5 3 3 5 3 3 5 3 4 5 3 6 3 5 3 1
## [1055] 3 3 3 5 3 3 3 5 3 1 3 3 1 3 3 5 3 3 5 3 3 3 3 3 3 5 5 3 3 5 3 3 3 5
## [1089] 1 3 1 3 3 3 3 5 5 3 3 3 3 3 3 3 1 3 3 3 5 3 3 1 3 1 3 5 5 3 1 6 6 3
## [1123] 3 3 3 3 5 2 3 3 5 3 3 1 5 3 2 5 6 1 3 5 1 3 5 5 2 6 5 3 6 3 3 3 1 5
## [1157] 3 3 5 1 5 1 6 1 3 6 3 1 1 5 5 3 3 3 3 6 1 2 5 5 6 5 5 1 6 3 5 1 5 5
## [1191] 6 1 2 4 1 5 6 1 6 5 6 5 6 6 3 4 4 5 1 3 5 6 1 5 4 6 6 4 3 4 1 2 6 7
## [1225] 3 4 2 4 4 3 3 6 5 3 3 3 1 6 3 6 5 6 5 3 3 5 5 1 3 5 5 6 5 2 3 3 1 5
## [1259] 5 5 5 2 1 5 3 1 6 6 3 4 3 3 1 3 1 6 3 3 4 3 1 5 5 3 1 3 6 1 3 6 5 7
## [1293] 3 3 3 3 3 3 6 3 3 6 6 1 5 3 1 1 1 2 7 5 3 2 5 5 5 3 1 5 5 1 5 3 5 1
## [1327] 3 3 3 1 2 3 5 3 3 5 5 3 7 3 3 5 5 3 3 5 3 3 3 3 3 3 3 3 5 3 3 3 3 3
## [1361] 5 5 3 5 3 3 6 1 3 3 3 5 3 2 3 3 3 1 3 3 6 1 1 3 6 5 3 3 3 3 3 3 3 6
## [1395] 3 3 5 1 3 5 5 3 3 3 5 3 3 3 3 3 3 3 5 5 3 1 1 3 3 3 3 5 6 6 3 3 3 3
## [1429] 6 3 3 3 1 3 5 5 1 3 3 1 5 5 1 1 5 5 5 3 5 3 3 5 5 5 3 5 3 3 3 6 5 3
## [1463] 5 3 3 5 3 3 3 3 3 3 3 5 1 3 3 3 3 3 5 3 3 3 3 5 3 3 3 3 6 1 5 3 5 5
## [1497] 1 3 3 1 3 3 5 3 6 3 1 3 3 3 3 3 3 3 3 5 1 3 3 6 3 3 3 3 3 3 5 3 4 1
## [1531] 6 5 3 5 5 5 3 5 3 3 3 3 3 3 5 3 3 3 3 3 3 3 3 5 3 3 3 3 3 3 5 5 3 1
## [1565] 5 5 3 3 3 3 3 3 2 3 3 1 7 3 3 3 5 3 3 5 5 3 5 3 3 3 3 3 5 3 3 2 3 3
## [1599] 3 3 3 3 1 3 3 3 3 3 3 3 1 1 3 3 3 3 3 3 3 5 1 3 3 3 3 3 3 1 3 3 3 3
## [1633] 3 3 3 3 5 3 3 3 3 3 5 3 3 3 3 3 3 3 3 6 5 3 3 3 3 3 3 3 3 5 3 3 3 3
## [1667] 3 3 3 3 3 3 3 3 3 3 3 3 5 2 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3
## [1701] 3 3 3 3 3 3 6 5 3 3 3 5 3 3 3 3 3 3 3 3 3 3 5 3 3 3 3 3 6 3 5 3 3 3
## [1735] 3 3 3 3 3 3 3 3 3 3 3 3 7 5 5 3 3 3 3 3 5 3 5 3 3 2 3 5 1 5 1 5 1 2
## [1769] 6 2 6 5 6 4 2 4 1 6 4 6 4 6 2 4 4 2 2 2 1 2 6 2 1 4 3 1 5 3 5 3 6 1
## [1803] 5 3 3 3 1 3 3 3 1 3 1 3 5 3 1 6 5 6 3 3 5 3 3 1 2 1 7 6 1 1 6 1 1 1
## [1837] 1 5 5 2 4 5 5 1 1 5 3 1 6 7 5 1 1 4 1 7 7 6 6 2 1 2 5 6 1 1 7 6 2 2
## [1871] 6 6 6 5 3 5 1 7 1 1 1 6 1 1 1 4 5 3 6 5 3 3 3 3 5 3 5 1 6 1 6 1 3 1
## [1905] 3 6 5 3 3 3 1 1 1 2 3 5 6 5 5 6 1 2 5 6 3 3 5 3 2 1 1 1 1 3 5 3 6 5
## [1939] 6 3 5 1 1 5 5 3 5 4 3 3 1 1 6 3 6 6 3 5 5 3 5 6 3 6 5 6 1 6 1 1 5 1
## [1973] 5 1 3 5 3 6 5 4 3 3 5 6 1 1 5 3 3 3 3 3 3 3 3 1 6 3 3 3 3 3 3 3 3 1
## [2007] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3
## [2041] 3 5 6 1 6 1 5 1 5 2 5 5 6 6 5 6 5 5 7 1 5 1 1 6 5 7 5 5 1 6 5 4 1 5
## [2075] 3 5 5 5 5 1 5 1 1 6 1 6 5 2 2 5 2 1 6 3 5 1 3 4 3 5 1 3 5 3 5 1 5 6
## [2109] 5 5 6 1 1 1 1 5 2 4 6 1 5 5 3 6 1 6 5 6 3 3 3 3 3 3 3 5 5 1 5 5 3 3
## [2143] 6 3 6 3 3 1 5 5 3 3 1 5 5 3 3 3 3 3 3 5 3 3 5 3 3 3 5 5 5 3 5 5 3 3
## [2177] 3 5 3 1 3 3 3 4 5 5 5 3 1 5 5 1 3 3 1 5 5 5 3 3 4 1 5 3 3 3 3 1 2 5
## [2211] 5 1 3 3 6 6 3 3 3 3 6 3 1 1 3 2 5 6 5 2 3 4 1 3 3 1 5 3 3 2 3 1 1 7
## [2245] 1 6 5 2 6 1 4 6 6 3 1 6 2 5 1 5 1 1 6 6 4 5 2 6 3 6 3 5 5 1 5 3 6 2
## [2279] 1 6 2 2 6 5 6 5 6 4 3 2 1 5 7 5 3 6 5 1 3 5 5 5 1 5 6 5 2 5 2 5 6 1
## [2313] 4 6 3 6 3 6 3 3 6 6 3 2 5 5 5 5 5 1 5 1 3 3 6 1 2 1 3 6 3 5 1 1 3 6
## [2347] 3 5 5 5 1 1 6 2 3 6 6 5 5 6 3 3 3 3 5 5 3 3 3 3 3 3 3 5 3 3 3 3 3 3
## [2381] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 6 3 1 3 3 3
## [2415] 3 3 3 3 3 3 3 3 3 3 3 3 1 5 3 3 6 1 5 3 5 1 5 3 5 3 5 5 3 5 4 3 3 5
## [2449] 5 5 3 5 5 5 3 1 3 1 2 3 3 3 5 3 3 5 3 3 3 3 5 3 2 3 3 5 3 5 5 5 3 3
## [2483] 1 5 5 1 3 5 6 3 3 5 3 3 3 3 1 5 5 1 6 3 3 1 4 3 3 6 6 5 3 3 3 3 5 6
## [2517] 3 5 3 6 1 1 3 1 3 3 3 5 3 3 3 5 3 5 6 7 3 3 3 1 6 6 3 3 3 5 3 5 5 3
## [2551] 3 2 3 3 5 3 3 5 3 3 3 3 3 2 3 3 1 3 3 5 1 3 3 3 3 3 3 7 3 3 3 2 3 3
## [2585] 3 3 3 3 6 3 6 4 5 3 5 3 3 3 3 2 3 3 3 3 6 3 3 3 3 3 3 6 6 3 1 5 3 3
## [2619] 3 3 5 7 1 3 3 1 3 1 4 5 3 5 5 3 5 3 1 3 3 3 3 5 3 6 3 5 6 3 3 1 3 3
## [2653] 3 5 3 3 3 5 3 5 3 3 3 3 3 3 1 3 3 3 3 3 6 3 3 6 3 3 3 3 3 5 5 5 3 6
## [2687] 3 3 3 3 2 3 3 3 1 5 3 3 2 3 3 1 5 3 1 3 3 5 6 3 3 1 3 3 3 3 3 3 3 5
## [2721] 3 5 3 3 3 1 3 3 3 3 3 3 6 3 1 3 3 3 3 3 7 6 3 3 3 5 6 4 3 3 5 3 5 5
## [2755] 5 1 1 5 3 5 6 5 3 6 3 3 6 5 3 5 5 3 3 3 3 3 5 1 3 3 6 3 3 3 3 5 3 3
## [2789] 3 3 3 3 4 3 3 3 5 5 5 2 3 1 3 6 5 5 5 6 3 5 3 3 5 5 1 1 5 1 5 1 3 3
## [2823] 5 3 6 1 3 1 3 5 3 5 3 1 3 5 3 3 2 3 3 5 3 3 3 3 4 1 3 3 5 1 3 5 3 3
## [2857] 3 3 5 1 2 1 3 5 5 3 3 3 3 3 6 3 3 3 3 5 3 1 3 3 3 3 3 3 3 3 1 3 3 5
## [2891] 2 5 3 3 1 3 1 5 3 5 5 3 1 1 3 3 5 5 1 3 5 5 1 6 3 3 3 5 6 3 3 5 3 3
## [2925] 3 3 3 3 6 5 3 3 1 5 3 3 6 6 3 5 3 6 3 6 1 3 3 1 2 3 3 3 3 3 6 1 1 2
## [2959] 3 1 5 3 5 3 1 1 1 5 7 6 5 3 1 3 5 5 3 3 4 3 1 3 4 2 5 6 3 1 6 5 6 3
## [2993] 1 5 3 5 1 3 3 3 5 3 3 5 3 5 3 1 5 5 6 3 3 5 5 1 5 5 1 5 5 1 3 3 5 5
## [3027] 3 3 3 5 1 1 5 3 3 3 3 3 3 3 5 3 3 3 1 5 3 3 5 3 6 3 3 5 1 5 1 3 2 1
## [3061] 5 5 5 1 3 1 3 5 5 3 3 3 3 1 3 6 3 6 3 3 5 1 6 5 3 3 4 5 5 5 6 1 3 5
## [3095] 5 1 3 6 3 6 3 1 1 3 5 6 3 5 5 3 1 3 6 2 1 3 6 1 5 3 5 3 3 3 5 3 3 3
## [3129] 1 3 1 3 5 3 5 3 5 3 3 3 3
## 
## Within cluster sum of squares by cluster:
## [1] 1.981612e+11 1.010009e+12 1.647334e+11 1.464945e+12 6.707753e+10
## [6] 8.321003e+11 8.886476e+13
##  (between_SS / total_SS =  89.5 %)
## 
## Available components:
## 
## [1] "cluster"      "centers"      "totss"        "withinss"    
## [5] "tot.withinss" "betweenss"    "size"         "iter"        
## [9] "ifault"
plot(demok,data=demo1)
 
#As the result shows, we devide this counties into 7 groups.
#the size of the 7 clusters are 293,1617,630,110,386,71,34
