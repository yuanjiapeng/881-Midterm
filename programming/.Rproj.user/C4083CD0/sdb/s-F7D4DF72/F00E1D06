{
    "contents" : "library(ggplot2)\nlibrary(qualityTools)\n# create a vector of w exponential waiting times with lambda = lam\n\nset.seed(50)\n\nwait <- function(w,lam){\n  a = NULL\n  for(i in 1:w){\n    a = c(a,rexp(1,rate = lam))\n  }\n  return(a)\n}\n\n#now we plot the waiting time to see if it is exponential\nw <- wait(100,2)\nw\n\nx <- seq(0,4,.1)\n\ny<-dexp(x,2)\n\np1 <- qplot(w, binwidth = .2) + geom_line(aes(x,y,color='red'))\np1 \nmean(w)\nsd(w)\n# when we run it we can see mean equla to standar deviation, so it is exponential\n\n###Jiayuan: \n##################################################################################\n#another way is to use qqplot to see if we can get a straight line, \n#this time, yes, so w has the same distribution as the Exponential \nqqplot(w,rexp(100,2))\n##################################################################################\n\n# now we generate poisson process until time reach M. we use the exponential waiting times above to generate poisson\npois = function(lam, M) {\n  out = wait(1,lam)\n  len = 1\n  while (out[len] < M) {\n    #adding values until reach M\n    out = c(out, out[len] + rexp(1, lam))\n    len = len + 1\n  }\n  # return value where less than M\n  return(out[-len])\n}\n\n# in order to check if pois is Poisson distribution, then we generate 10000 of these with lambda=2, and M=1.\n#and the lengths of the vector return in each case shoud be Poisson. so we plot it as a Histogram\n# and we also calculate the mean and variance, and it turns out the mean=variance=lambda\n# Thus, it is Poisson\nlens<-numeric(10000)\nfor (i in 1:10000) lens[i]<-length(pois(2,1))#lam=2,M=1\nhist(lens)\nmean(lens)\nvar(lens)\n\n###Jiayuan:\n##################################################################################\n#qplot the hisgram\nqplot(lens, geom = \"histogram\") \n\n#again, another way is to use qqplot to see if we can get a straight line, \n#this time, yes, so w has the same distribution as the Poisson \nqqplot(lens,rpois(10000,2))\n\n#check the mean and variance，they are the same as the mean and variance you get above \nmean(rpois(1000,2))   \nvar(rpois(1000,2)) \n#so it is Poisson for sure\n##################################################################################\n\n# Conclusion: if X is Poisson with parameter lambda.then the time until the first arrival is exponential with parameter lambda.\n\n###Jiayuan:\n##################################################################################\n#I think the conclusion should be if there is a vector of w exponential waiting times with lambda = lam,\n#so the number of events have a poisson distribution with parameter lam\n##################################################################################\n\n# Now we want to find the relationship between Poisson and gamma distribution\n# now simlate the waiting time until k events to occur with lambda = lam\n\nwait.for <- function(k, lam){\n  time = 0\n  count = 0\n  a = NULL\n  while(count < k){\n    inter=rexp(1,lam)\n    count = count + 1\n    time = time+inter\n  }\n  \n  return(time) # time should be gamma\n} \n\n###Jiayuan:\n##################################################################################\n#check: after set seed,\n#the total waiting time for 5 events to occur with lambda = 2 with set.seed(50)\n#is the same as the sum of interval waiting time, using the function wait() above\nset.seed(50)\nwait.for(5,2) \nset.seed(50)\nsum(wait(5,2)) \n##################################################################################\n\n#Now let's test if we succeed generate the gamma distribution.\n\ngam.test <-function(rep, k, lam ){\n  a=NULL\n  for (i in 1:rep){\n    t = wait.for(k,lam)\n    a = c(a,t)\n    \n  }\n  \n  return(a)\n}\n#first, we plot the the gam.test with 1000 times and k=2, lam=2\n#then we calculate mean and variance\n#we find that mean=k*(1/lam) ,  var=k*(1/lam)^2, Thus it is Gamma distirbution\ngamm<-gam.test(1000,2,2)\nhist(gamm)\n\n###Jiayuan:\n##################################################################################\nmean(gamm) #equals to 0.977 = 2/2 = k/lam\nvar(gamm) #equals to 0.5153 = 5/2^2 = k/lam^2\n\n#qplot the hisgram\nqplot(gamm, geom = \"histogram\") \n\n#again, another way is to use qqplot to see if we can get a straight line, \n#this time, yes, so w has the same distribution as the Gamma \nqqplot(gamm,rgamma(10000,2,2))\n\n#check the mean and variance，they are the same as the mean and variance you get above \nmean(rgamma(1000,2,2))\nvar(rgamma(1000,2,2)) \n#so the total waiting time has a Gamma distribution with parameter 2,2, \n#which is the number of events and lambda\n##################################################################################\n\n#Conclusion: If X~Poisson(lamba),then the time until k arrivals is Gamma(k,1/ lambda)\n",
    "created" : 1444953580668.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3399824670",
    "id" : "F00E1D06",
    "lastKnownWriteTime" : 1444943269,
    "path" : "~/881-Midterm/programming/programming.Jiayuan.R",
    "project_path" : "programming.Jiayuan.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}